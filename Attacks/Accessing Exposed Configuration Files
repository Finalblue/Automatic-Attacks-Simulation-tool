import requests

def find_sensitive_files(base_url):
    """
    Recherche et extrait des fichiers sensibles exposés sur le serveur.
    """
    sensitive_files = [
        ".env", "config.json", "backup.sql", "secrets.txt",
        "config.php", "db.sqlite", "database.yml", "admin.json"
    ]

    print("[STARTING SCAN FOR SENSITIVE FILES]")
    for file in sensitive_files:
        url = f"{base_url}/{file}"
        try:
            response = requests.get(url, timeout=5)
            if response.status_code == 200:
                print(f"\n[SENSITIVE FILE FOUND] {url}")
                print(f"Headers: {response.headers}")
                print(f"Content Preview: {response.text[:500]}...\n")  # Affiche un aperçu du fichier
            elif response.status_code == 403:
                print(f"[ACCESS DENIED] {url} (Forbidden)")
            elif response.status_code == 404:
                print(f"[NOT FOUND] {url}")
            else:
                print(f"[UNEXPECTED RESPONSE] {url} (Status: {response.status_code})")
        except requests.RequestException as e:
            print(f"[ERROR] Unable to access {url} - {e}")

# Test sur Juice Shop
find_sensitive_files("http://45.76.47.218:3000")

